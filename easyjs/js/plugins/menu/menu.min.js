if(typeof LigerUIMenu=="undefined")LigerUIMenu={};(function(e){e.ligerDefaults=e.ligerDefaults||{};e.ligerDefaults.Menu={width:120,top:0,left:0,items:null,shadow:true,afterHide:null};e.ligerMenu=function(i){i=e.extend({},e.ligerDefaults.Menu,i||{});var t={show:function(n,u){var s=e(window).width();var l=e(window).height()+e(document).scrollTop();if(u==undefined)u=t.menu;if(n&&n.left!=undefined){var d=s-n.left>i.width?n.left:n.left-i.width;u.css({left:d})}if(n&&n.top!=undefined){var m=l-n.top>u.height()?n.top:l-u.height()-10;u.css({top:m})}if(e(".l-checked").size()>1){e(".l-menu-item[singlerow=true]").addClass("l-menu-item-disable")}else{e(".l-menu-item").removeClass("l-menu-item-disable")}u.show();t.updateShadow(u)},updateShadow:function(e){if(!i.shadow)return;e.shadow.css({left:e.css("left"),top:e.css("top"),width:e.outerWidth(),height:e.outerHeight()});if(e.is(":visible"))e.shadow.show();else e.shadow.hide()},hide:function(e){if(e==undefined)e=t.menu;t.hideAllSubMenu(e);e.hide();t.updateShadow(e)},toggle:function(){t.menu.toggle();t.updateShadow(t.menu)},removeItem:function(i){e("> .l-menu-item[menuitemid="+i+"]",t.menu.items).remove();t.itemCount--},setEnable:function(i){e("> .l-menu-item[menuitemid="+i+"]",t.menu.items).removeClass("l-menu-item-disable")},setDisable:function(i){e("> .l-menu-item[menuitemid="+i+"]",t.menu.items).addClass("l-menu-item-disable")},isEnable:function(i){return!e("> .l-menu-item[menuitemid="+i+"]",t.menu.items).hasClass("l-menu-item-disable")},getItemCount:function(){return e("> .l-menu-item",t.menu.items).length},addItem:function(n,u){if(!n)return;if(u==undefined)u=t.menu;if(n.line){u.items.append('<div class="l-menu-item-line"></div>');return}var s=e('<div class="l-menu-item"><div class="l-menu-item-text"></div> </div>');var l=e("> .l-menu-item",u.items).length;u.items.append(s);n.id&&s.attr("menuitemid",n.id);n.text&&e(">.l-menu-item-text:first",s).html(n.text);n.icon&&s.prepend('<div class="l-menu-item-icon l-icon-'+n.icon+'"></div>');n.disable&&s.addClass("l-menu-item-disable");n.singleRow&&s.attr("singleRow",n.singleRow);if(n.children){if(s.attr("menuitemid")==undefined)s.attr("menuitemid",(new Date).getTime());s.append('<div class="l-menu-item-arrow"></div>');var d=t.createMenu(s.attr("menuitemid"));LigerUIMenu[s.attr("menuitemid")]=d;d.width(i.width);d.hover(null,function(){if(!d.showedSubMenu)t.hide(d)});e(n.children).each(function(){t.addItem(this,d)})}n.click&&s.click(function(){if(e(this).hasClass("l-menu-item-disable"))return;n.click(n,l)});n.dblclick&&s.dblclick(function(){if(e(this).hasClass("l-menu-item-disable"))return;n.dblclick(n,l)});var m=e("> .l-menu-over:first",u);s.hover(function(){if(e(this).hasClass("l-menu-item-disable"))return;var i=e(this).offset().top;var s=i-u.offset().top;m.css({top:s});t.hideAllSubMenu(u);if(n.children){var l=e(this).attr("menuitemid");if(!l)return;if(LigerUIMenu[l]){t.show({top:i,left:e(this).offset().left+e(this).width()-5},LigerUIMenu[l]);u.showedSubMenu=true}}},function(){if(e(this).hasClass("l-menu-item-disable"))return;var i=e(this).attr("menuitemid");if(n.children){var i=e(this).attr("menuitemid");if(!i)return}})},hideAllSubMenu:function(i){if(i==undefined)i=t.menu;e("> .l-menu-item",i.items).each(function(){if(e("> .l-menu-item-arrow",this).length>0){var i=e(this).attr("menuitemid");if(!i)return;LigerUIMenu[i]&&t.hide(LigerUIMenu[i])}});i.showedSubMenu=false},createMenu:function(n){var u=e('<div class="l-menu" style="display:none"><div class="l-menu-yline"></div><div class="l-menu-over"><div class="l-menu-over-l"></div> <div class="l-menu-over-r"></div></div><div class="l-menu-inner"></div></div>');n&&u.attr("parentmenuitemid",n);u.items=e("> .l-menu-inner:first",u);u.appendTo("body");if(i.shadow){u.shadow=e('<div class="l-menu-shadow"></div>').insertAfter(u);t.updateShadow(u)}u.hover(null,function(){if(!u.showedSubMenu)e("> .l-menu-over:first",u).css({top:-24})});return u}};t.menu=t.createMenu();t.menu.css({top:i.top,left:i.left,width:i.width});i.items&&e(i.items).each(function(e,i){t.addItem(i)});e(document).click(function(){e(".l-menu,.l-menu-shadow").hide();if(i.afterHide)i.afterHide()});return t}})(jQuery);