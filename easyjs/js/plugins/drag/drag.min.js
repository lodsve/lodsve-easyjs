(function(t){var a=false;function e(a){var e=t.data(a.data.target,"draggable").options;var r=a.data;var d=r.startLeft+a.pageX-r.startX;var n=r.startTop+a.pageY-r.startY;if(e.deltaX!=null&&e.deltaX!=undefined){d=a.pageX+e.deltaX}if(e.deltaY!=null&&e.deltaY!=undefined){n=a.pageY+e.deltaY}if(a.data.parent!=document.body){d+=t(a.data.parent).scrollLeft();n+=t(a.data.parent).scrollTop()}if(e.axis=="h"){r.left=d}else if(e.axis=="v"){r.top=n}else{r.left=d;r.top=n}}function r(a){var e=t.data(a.data.target,"draggable").options;var r=t.data(a.data.target,"draggable").proxy;if(!r){r=t(a.data.target)}r.css({left:a.data.left,top:a.data.top});t("body").css("cursor",e.cursor)}function d(d){a=true;var n=t.data(d.data.target,"draggable").options;var o=t(".droppable").filter(function(){return d.data.target!=this}).filter(function(){var a=t.data(this,"droppable").options.accept;if(a){return t(a).filter(function(){return this==d.data.target}).length>0}else{return true}});t.data(d.data.target,"draggable").droppables=o;var s=t.data(d.data.target,"draggable").proxy;if(!s){if(n.proxy){if(n.proxy=="clone"){s=t(d.data.target).clone().insertAfter(d.data.target)}else{s=n.proxy.call(d.data.target,d.data.target)}t.data(d.data.target,"draggable").proxy=s}else{s=t(d.data.target)}}s.css("position","absolute");e(d);r(d);n.onStartDrag.call(d.data.target,d);return false}function n(a){e(a);if(t.data(a.data.target,"draggable").options.onDrag.call(a.data.target,a)!=false){r(a)}var d=a.data.target;t.data(a.data.target,"draggable").droppables.each(function(){var e=t(this);if(e.droppable("options").disabled){return}var r=e.offset();if(a.pageX>r.left&&a.pageX<r.left+e.outerWidth()&&a.pageY>r.top&&a.pageY<r.top+e.outerHeight()){if(!this.entered){t(this).trigger("_dragenter",[d]);this.entered=true}t(this).trigger("_dragover",[d])}else{if(this.entered){t(this).trigger("_dragleave",[d]);this.entered=false}}});return false}function o(r){a=false;e(r);var d=t.data(r.data.target,"draggable").proxy;var n=t.data(r.data.target,"draggable").options;if(n.revert){if(s()==true){t(r.data.target).css({position:r.data.startPosition,left:r.data.startLeft,top:r.data.startTop})}else{if(d){d.animate({left:r.data.startLeft,top:r.data.startTop},function(){o()})}else{t(r.data.target).animate({left:r.data.startLeft,top:r.data.startTop},function(){t(r.data.target).css("position",r.data.startPosition)})}}}else{t(r.data.target).css({position:"absolute",left:r.data.left,top:r.data.top});s()}n.onStopDrag.call(r.data.target,r);t(document).unbind(".draggable");setTimeout(function(){t("body").css("cursor","")},100);function o(){if(d){d.remove()}t.data(r.data.target,"draggable").proxy=null}function s(){var a=false;t.data(r.data.target,"draggable").droppables.each(function(){var e=t(this);if(e.droppable("options").disabled){return}var d=e.offset();if(r.pageX>d.left&&r.pageX<d.left+e.outerWidth()&&r.pageY>d.top&&r.pageY<d.top+e.outerHeight()){if(n.revert){t(r.data.target).css({position:r.data.startPosition,left:r.data.startLeft,top:r.data.startTop})}o();t(this).trigger("_drop",[r.data.target]);a=true;this.entered=false;return false}});if(!a&&!n.revert){o()}return a}return false}t.fn.draggable=function(e,r){if(typeof e=="string"){return t.fn.draggable.methods[e](this,r)}return this.each(function(){var r;var s=t.data(this,"draggable");if(s){s.handle.unbind(".draggable");r=t.extend(s.options,e)}else{r=t.extend({},t.fn.draggable.defaults,e||{})}if(r.disabled==true){t(this).css("cursor","");return}var i=null;if(typeof r.handle=="undefined"||r.handle==null){i=t(this)}else{i=typeof r.handle=="string"?t(r.handle,this):r.handle}t.data(this,"draggable",{options:r,handle:i});i.unbind(".draggable").bind("mousemove.draggable",{target:this},function(e){if(a)return;var r=t.data(e.data.target,"draggable").options;if(g(e)){t(this).css("cursor",r.cursor)}else{t(this).css("cursor","")}}).bind("mouseleave.draggable",{target:this},function(a){t(this).css("cursor","")}).bind("mousedown.draggable",{target:this},function(a){if(g(a)==false)return;t(this).css("cursor","");var e=t(a.data.target).position();var r={startPosition:t(a.data.target).css("position"),startLeft:e.left,startTop:e.top,left:e.left,top:e.top,startX:a.pageX,startY:a.pageY,target:a.data.target,parent:t(a.data.target).parent()[0]};t.extend(a.data,r);var s=t.data(a.data.target,"draggable").options;if(s.onBeforeDrag.call(a.data.target,a)==false)return;t(document).bind("mousedown.draggable",a.data,d);t(document).bind("mousemove.draggable",a.data,n);t(document).bind("mouseup.draggable",a.data,o)});function g(a){var e=t.data(a.data.target,"draggable");var r=e.handle;var d=t(r).offset();var n=t(r).outerWidth();var o=t(r).outerHeight();var s=a.pageY-d.top;var i=d.left+n-a.pageX;var g=d.top+o-a.pageY;var l=a.pageX-d.left;return Math.min(s,i,g,l)>e.options.edge}})};t.fn.draggable.methods={options:function(a){return t.data(a[0],"draggable").options},proxy:function(a){return t.data(a[0],"draggable").proxy},enable:function(a){return a.each(function(){t(this).draggable({disabled:false})})},disable:function(a){return a.each(function(){t(this).draggable({disabled:true})})}};t.fn.draggable.defaults={proxy:null,revert:false,cursor:"move",deltaX:null,deltaY:null,handle:null,disabled:false,edge:0,axis:null,onBeforeDrag:function(t){},onStartDrag:function(t){},onDrag:function(t){},onStopDrag:function(t){}}})(jQuery);