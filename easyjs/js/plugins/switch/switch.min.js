(function(){var e;var i=Array.prototype.slice;e=function(){function e(i,t){var n,s,a;this.elem=$(i);s=$.extend({},e.defaults,t);for(n in s){a=s[n];this[n]=a}this.elem.data(this.dataName,this);this.wrapCheckboxWithDivs();this.attachEvents();this.disableTextSelection();if(this.resizeHandle){this.optionallyResize("handle")}if(this.resizeContainer){this.optionallyResize("container")}this.initialPosition()}e.prototype.isDisabled=function(){return this.elem.is(":disabled")};e.prototype.wrapCheckboxWithDivs=function(){this.elem.wrap("<div class='"+this.containerClass+"' />");this.container=this.elem.parent();this.offLabel=$("<label class='"+this.labelOffClass+"'>\n  <span>"+this.uncheckedLabel+"</span>\n</label>").appendTo(this.container);this.offSpan=this.offLabel.children("span");this.onLabel=$("<label class='"+this.labelOnClass+"'>\n  <span>"+this.checkedLabel+"</span>\n</label>").appendTo(this.container);this.onSpan=this.onLabel.children("span");return this.handle=$("<div class='"+this.handleClass+"'>\n  <div class='"+this.handleRightClass+"'>\n    <div class='"+this.handleCenterClass+"' >\n <div class='split'></div>\n</div>  </div>\n</div>").appendTo(this.container)};e.prototype.disableTextSelection=function(){if($.browser.msie){return $([this.handle,this.offLabel,this.onLabel,this.container]).attr("unselectable","on")}};e.prototype._getDimension=function(e,i){if($.fn.actual!=null){return e.actual(i)}else{return e[i]()}};e.prototype.optionallyResize=function(e){var i,t,n;n=this._getDimension(this.onLabel,"width");t=this._getDimension(this.offLabel,"width");if(e==="container"){i=n>t?n:t;i+=this._getDimension(this.handle,"width")+this.handleMargin;return this.container.css({width:i})}else{i=n>t?n:t;return this.handle.css({width:i})}};e.prototype.onMouseDown=function(i){var t;i.preventDefault();if(this.isDisabled()){return}t=i.pageX||i.originalEvent.changedTouches[0].pageX;e.currentlyClicking=this.handle;e.dragStartPosition=t;return e.handleLeftOffset=parseInt(this.handle.css("left"),10)||0};e.prototype.onDragMove=function(i,t){var n,s;if(e.currentlyClicking!==this.handle){return}s=(t+e.handleLeftOffset-e.dragStartPosition)/this.rightSide;if(s<0){s=0}if(s>1){s=1}n=s*this.rightSide;this.handle.css({left:n});this.onLabel.css({width:n+this.handleRadius});this.offSpan.css({marginRight:-n});return this.onSpan.css({marginLeft:-(1-s)*this.rightSide})};e.prototype.onDragEnd=function(i,t){var n;if(e.currentlyClicking!==this.handle){return}if(this.isDisabled()){return}if(e.dragging){n=(t-e.dragStartPosition)/this.rightSide;this.elem.prop("checked",n>=.5)}else{this.elem.prop("checked",!this.elem.prop("checked"))}e.currentlyClicking=null;e.dragging=null;return this.didChange()};e.prototype.refresh=function(){return this.didChange()};e.prototype.didChange=function(){var e;if(typeof this.onChange==="function"){this.onChange(this.elem,this.elem.prop("checked"))}if(this.isDisabled()){this.container.addClass(this.disabledClass);return false}else{this.container.removeClass(this.disabledClass)}e=this.elem.prop("checked")?this.rightSide:0;this.handle.animate({left:e},this.duration);this.onLabel.animate({width:e+this.handleRadius},this.duration);this.offSpan.animate({marginRight:-e},this.duration);return this.onSpan.animate({marginLeft:e-this.rightSide},this.duration)};e.prototype.attachEvents=function(){var e,i,t;t=this;e=function(e){return t.onGlobalMove.apply(t,arguments)};i=function(n){t.onGlobalUp.apply(t,arguments);$(document).unbind("mousemove touchmove",e);return $(document).unbind("mouseup touchend",i)};this.elem.change(function(){return t.refresh()});return this.container.bind("mousedown touchstart",function(n){t.onMouseDown.apply(t,arguments);$(document).bind("mousemove touchmove",e);return $(document).bind("mouseup touchend",i)})};e.prototype.initialPosition=function(){var e,i;e=this._getDimension(this.container,"width");this.offLabel.css({width:e-this.containerRadius});i=this.containerRadius+1;if($.browser.msie&&$.browser.version<7){i-=3}this.rightSide=e-this._getDimension(this.handle,"width")-i;if(this.elem.is(":checked")){this.handle.css({left:this.rightSide});this.onLabel.css({width:this.rightSide+this.handleRadius});this.offSpan.css({marginRight:-this.rightSide})}else{this.onLabel.css({width:0});this.onSpan.css({marginLeft:-this.rightSide})}if(this.isDisabled()){return this.container.addClass(this.disabledClass)}};e.prototype.onGlobalMove=function(i){var t;if(!(!this.isDisabled()&&e.currentlyClicking)){return}i.preventDefault();t=i.pageX||i.originalEvent.changedTouches[0].pageX;if(!e.dragging&&Math.abs(e.dragStartPosition-t)>this.dragThreshold){e.dragging=true}return this.onDragMove(i,t)};e.prototype.onGlobalUp=function(i){var t;if(!e.currentlyClicking){return}i.preventDefault();t=i.pageX||i.originalEvent.changedTouches[0].pageX;this.onDragEnd(i,t);return false};e.defaults={duration:200,checkedLabel:"ON",uncheckedLabel:"OFF",resizeHandle:true,resizeContainer:true,disabledClass:"iPhoneCheckDisabled",containerClass:"iPhoneCheckContainer",labelOnClass:"iPhoneCheckLabelOn",labelOffClass:"iPhoneCheckLabelOff",handleClass:"iPhoneCheckHandle",handleCenterClass:"iPhoneCheckHandleCenter",handleRightClass:"iPhoneCheckHandleRight",dragThreshold:5,handleMargin:15,handleRadius:4,containerRadius:5,dataName:"iphoneStyle",onChange:function(){}};return e}();$.iphoneStyle=this.iOSCheckbox=e;$.fn.iphoneStyle=function(){var t,n,s,a,h,l,r,o,d,c,u,f;t=1<=arguments.length?i.call(arguments,0):[];s=(d=(c=t[0])!=null?c.dataName:void 0)!=null?d:e.defaults.dataName;u=this.filter(":checkbox");for(r=0,o=u.length;r<o;r++){n=u[r];a=$(n).data(s);if(a!=null){h=t[0],l=2<=t.length?i.call(t,1):[];if((f=a[h])!=null){f.apply(a,l)}}else{new e(n,t[0])}}return this};$.fn.iOSCheckbox=function(e){var i;if(e==null){e={}}i=$.extend({},e,{resizeHandle:false,disabledClass:"iOSCheckDisabled",containerClass:"iOSCheckContainer",labelOnClass:"iOSCheckLabelOn",labelOffClass:"iOSCheckLabelOff",handleClass:"iOSCheckHandle",handleCenterClass:"iOSCheckHandleCenter",handleRightClass:"iOSCheckHandleRight",dataName:"iOSCheckbox"});return this.iphoneStyle(i)}}).call(this);