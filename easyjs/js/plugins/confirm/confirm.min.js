(function(e){e.confirm=e.confirm||{};e.confirm.defaults={header:"",confirmMessage:"确定删除该%s吗？",isFormatMessage:true,isDelFoot:true,removeElement:null,confirmFunc:null,cancelFunc:null,customSucTip:null,customErrTip:null,handleData:null,beforeSubmit:null,width:250,height:52};e.confirm.linkConfirm=e.confirm.linkConfirm||null;e.fn.confirm=function(i){this.each(function(){i=e.extend({},e.confirm.defaults,i||{});var n=e(this);var t={getBody:function(){if(!i.isFormatMessage){return'<h3 class="content">'+i.confirmMessage+"</h3>"}else{return'<h3 class="content">'+"确定删除该%s吗？".replace(/%s/,i.confirmMessage)+"</h3>"}},getDelFoot:function(){var e="";if(i.isDelFoot){e="删除"}else{e="确定"}return'<p class="act">'+'   <input type="button" class="f-button f-confirm confirm" value="'+e+'" id="buttonDel"/>'+'   <input type="button" class="f-button f-cancel close" value="取消"/>'+"</p>"+'<div id="decor" class="decor"></div>'},getOffset:function(t){var o=n.offset();var r=o.top-(i.height+33);var c=o.left-i.width*.8;var s=e(window).width();var f=e(window).height();if(r<i.height){r=o.top+33;if(t)e("#decor").removeClass("decor").addClass("decor1").css("bottom",i.height+20+"px")}if(c<0){c=0;if(t)e("#decor").css("left",o.left+5)}else if(c+i.width>s){c=s-i.width-22;if(t)e("#decor").css("left",o.left-c+5)}return[c,r]},getLinkConfirm:function(){e.confirm.linkConfirm=new YAHOO.widget.Overlay("overlay2",{xy:this.getOffset(false),visible:false,width:i.width,height:i.height});e.confirm.linkConfirm.setHeader(i.header);e.confirm.linkConfirm.setBody(this.getBody());e.confirm.linkConfirm.setFooter(this.getDelFoot());e.confirm.linkConfirm.render(document.body);e("#overlay2").css("width",i.width);e("#overlay2").css("height",i.height);e("div.bd",e("#overlay2")).css("height",i.height-20);this.getOffset(true);e.confirm.linkConfirm.show();this.addCancelEvent();this.addConfirmEvent();this.addWindowEvent()},addCancelEvent:function(){e("input[type=button].close").click(function(){e.confirm.linkConfirm.hide();e(document).unbind("mousedown");if(i.cancelFunc){return i.cancelFunc(e.confirm.linkConfirm)}})},addConfirmEvent:function(){e("input[type=button].confirm").click(function(){if(i.confirmFunc){return i.confirmFunc(e.confirm.linkConfirm)}else{var o=n.attr("rel");var r=true;if(i.beforeSubmit){r=i.beforeSubmit()}if(o&&r){t.asyncPost(o);e.confirm.linkConfirm.hide()}}})},asyncPost:function(n){e.ajax({type:"post",url:n,dataType:"json",data:t.handleData(),success:function(n){e(document).unbind("mousedown");try{if(n.status==1){if(i.removeElement){i.removeElement.hide();if(i.customSucTip){return i.customSucTip(n.status)}else{if(i.isDelFoot)t.showTip("suc",i.removeElement)}}}else{if(i.customErrTip){return i.customErrTip(n.status)}else{t.showTip("err",i.removeElement)}}}catch(o){}},error:function(i){e(document).unbind("mousedown");alert("错误信息:"+i.status)}})},showTip:function(i,n){var t=window.document.createElement("span");t.id="tip"+n.attr("id");t.innerHTML=i=="suc"?"删除成功":"删除失败";t.className=i=="suc"?"sucTip":"errTip";n.before(t);setTimeout(function(){e("#tip"+n.attr("id")).hide()},500)},handleData:function(){if(i.handleData){return i.handleData()}else{return""}},addWindowEvent:function(){var n=function(n){var o=n.pageX;var r=n.pageY;var c=t.getOffset();if(e("#overlay2").css("visibility")&&e("#overlay2").css("visibility")=="visible"){if(!(o>c[0]&&o<c[0]+i.width+25&&(r>c[1]&&r<c[1]+i.height+33))){if(e.confirm.linkConfirm){e.confirm.linkConfirm.hide();e(document).unbind("mousedown")}}}};e(document).bind("mousedown",n)}};n.click(function(){t.getLinkConfirm()})})}})(jQuery);function showTip(e,i,n){}