(function(t){var i=[],s=/^url\(["']?([^"'\)]*)["']?\);?$/i,e=/\.png$/i,o=!!window.createPopup&&document.documentElement.currentStyle.minWidth=="undefined";function a(){t.each(i,function(){this.refresh(true)})}t(window).resize(a);t.Poshytip=function(i,s){this.$elm=t(i);this.opts=t.extend({},t.fn.poshytip.defaults,s);this.$tip=t(['<div class="',this.opts.className,'">','<div class="tip-inner tip-bg-image"></div>','<div class="tip-arrow tip-arrow-top tip-arrow-right tip-arrow-bottom tip-arrow-left"></div>',"</div>"].join("")).appendTo(document.body);this.$arrow=this.$tip.find("div.tip-arrow");this.$inner=this.$tip.find("div.tip-inner");this.disabled=false;this.content=null;this.init()};t.Poshytip.prototype={init:function(){i.push(this);var s=this.$elm.attr("title");this.$elm.data("title.poshytip",s!==undefined?s:null).data("poshytip",this);if(this.opts.showOn!="none"){this.$elm.bind({"mouseenter.poshytip":t.proxy(this.mouseenter,this),"mouseleave.poshytip":t.proxy(this.mouseleave,this)});switch(this.opts.showOn){case"hover":if(this.opts.alignTo=="cursor")this.$elm.bind("mousemove.poshytip",t.proxy(this.mousemove,this));if(this.opts.allowTipHover)this.$tip.hover(t.proxy(this.clearTimeouts,this),t.proxy(this.mouseleave,this));break;case"focus":this.$elm.bind({"focus.poshytip":t.proxy(this.showDelayed,this),"blur.poshytip":t.proxy(this.hideDelayed,this)});break}}},mouseenter:function(t){if(this.disabled)return true;this.$elm.attr("title","");if(this.opts.showOn=="focus")return true;this.showDelayed()},mouseleave:function(t){if(this.disabled||this.asyncAnimating&&(this.$tip[0]===t.relatedTarget||jQuery.contains(this.$tip[0],t.relatedTarget)))return true;if(!this.$tip.data("active")){var i=this.$elm.data("title.poshytip");if(i!==null)this.$elm.attr("title",i)}if(this.opts.showOn=="focus")return true;this.hideDelayed()},mousemove:function(t){if(this.disabled)return true;this.eventX=t.pageX;this.eventY=t.pageY;if(this.opts.followCursor&&this.$tip.data("active")){this.calcPos();this.$tip.css({left:this.pos.l,top:this.pos.t});if(this.pos.arrow)this.$arrow[0].className="tip-arrow tip-arrow-"+this.pos.arrow}},show:function(){if(this.disabled||this.$tip.data("active"))return;this.reset();this.update();if(!this.content)return;this.display();if(this.opts.timeOnScreen)this.hideDelayed(this.opts.timeOnScreen)},showDelayed:function(i){this.clearTimeouts();this.showTimeout=setTimeout(t.proxy(this.show,this),typeof i=="number"?i:this.opts.showTimeout)},hide:function(){if(this.disabled||!this.$tip.data("active"))return;this.display(true)},hideDelayed:function(i){this.clearTimeouts();this.hideTimeout=setTimeout(t.proxy(this.hide,this),typeof i=="number"?i:this.opts.hideTimeout)},reset:function(){this.$tip.queue([]).detach().css("visibility","hidden").data("active",false);this.$inner.find("*").poshytip("hide");if(this.opts.fade)this.$tip.css("opacity",this.opacity);this.$arrow[0].className="tip-arrow tip-arrow-top tip-arrow-right tip-arrow-bottom tip-arrow-left";this.asyncAnimating=false},update:function(t,i){if(this.disabled)return;var s=t!==undefined;if(s){if(!i)this.opts.content=t;if(!this.$tip.data("active"))return}else{t=this.opts.content}var e=this,o=typeof t=="function"?t.call(this.$elm[0],function(t){e.update(t)}):t=="[title]"?this.$elm.data("title.poshytip"):t;if(this.content!==o){this.$inner.empty().append(o);this.content=o}this.refresh(s)},refresh:function(i){if(this.disabled)return;if(i){if(!this.$tip.data("active"))return;var a={left:this.$tip.css("left"),top:this.$tip.css("top")}}this.$tip.css({left:0,top:0}).appendTo(document.body);if(this.opacity===undefined)this.opacity=this.$tip.css("opacity");var h=this.$tip.css("background-image").match(s),r=this.$arrow.css("background-image").match(s);if(h){var p=e.test(h[1]);if(o&&p){this.$tip.css("background-image","none");this.$inner.css({margin:0,border:0,padding:0});h=p=false}else{this.$tip.prepend('<table class="tip-table" border="0" cellpadding="0" cellspacing="0"><tr><td class="tip-top tip-bg-image" colspan="2"><span></span></td><td class="tip-right tip-bg-image" rowspan="2"><span></span></td></tr><tr><td class="tip-left tip-bg-image" rowspan="2"><span></span></td><td></td></tr><tr><td class="tip-bottom tip-bg-image" colspan="2"><span></span></td></tr></table>').css({border:0,padding:0,"background-image":"none","background-color":"transparent"}).find(".tip-bg-image").css("background-image",'url("'+h[1]+'")').end().find("td").eq(3).append(this.$inner)}if(p&&!t.support.opacity)this.opts.fade=false}if(r&&!t.support.opacity){if(o&&e.test(r[1])){r=false;this.$arrow.css("background-image","none")}this.opts.fade=false}var n=this.$tip.find("> table.tip-table");if(o){this.$tip[0].style.width="";n.width("auto").find("td").eq(3).width("auto");var l=this.$tip.width(),d=parseInt(this.$tip.css("min-width")),f=parseInt(this.$tip.css("max-width"));if(!isNaN(d)&&l<d)l=d;else if(!isNaN(f)&&l>f)l=f;this.$tip.add(n).width(l).eq(0).find("td").eq(3).width("100%")}else if(n[0]){n.width("auto").find("td").eq(3).width("auto").end().end().width(document.defaultView&&document.defaultView.getComputedStyle&&parseFloat(document.defaultView.getComputedStyle(this.$tip[0],null).width)||this.$tip.width()).find("td").eq(3).width("100%")}this.tipOuterW=this.$tip.outerWidth();this.tipOuterH=this.$tip.outerHeight();this.calcPos();if(r&&this.pos.arrow){this.$arrow[0].className="tip-arrow tip-arrow-"+this.pos.arrow;this.$arrow.css("visibility","inherit")}if(i&&this.opts.refreshAniDuration){this.asyncAnimating=true;var c=this;this.$tip.css(a).animate({left:this.pos.l,top:this.pos.t},this.opts.refreshAniDuration,function(){c.asyncAnimating=false})}else{this.$tip.css({left:this.pos.l,top:this.pos.t})}},display:function(i){var s=this.$tip.data("active");if(s&&!i||!s&&i)return;this.$tip.stop();if((this.opts.slide&&this.pos.arrow||this.opts.fade)&&(i&&this.opts.hideAniDuration||!i&&this.opts.showAniDuration)){var e={},o={};if(this.opts.slide&&this.pos.arrow){var a,h;if(this.pos.arrow=="bottom"||this.pos.arrow=="top"){a="top";h="bottom"}else{a="left";h="right"}var r=parseInt(this.$tip.css(a));e[a]=r+(i?0:this.pos.arrow==h?-this.opts.slideOffset:this.opts.slideOffset);o[a]=r+(i?this.pos.arrow==h?this.opts.slideOffset:-this.opts.slideOffset:0)+"px"}if(this.opts.fade){e.opacity=i?this.$tip.css("opacity"):0;o.opacity=i?0:this.opacity}this.$tip.css(e).animate(o,this.opts[i?"hideAniDuration":"showAniDuration"])}i?this.$tip.queue(t.proxy(this.reset,this)):this.$tip.css("visibility","inherit");if(s){var p=this.$elm.data("title.poshytip");if(p!==null)this.$elm.attr("title",p)}this.$tip.data("active",!s)},disable:function(){this.reset();this.disabled=true},enable:function(){this.disabled=false},destroy:function(){this.reset();this.$tip.remove();delete this.$tip;this.content=null;this.$elm.unbind(".poshytip").removeData("title.poshytip").removeData("poshytip");i.splice(t.inArray(this,i),1)},clearTimeouts:function(){if(this.showTimeout){clearTimeout(this.showTimeout);this.showTimeout=0}if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=0}},calcPos:function(){var i={l:0,t:0,arrow:""},s=t(window),e={l:s.scrollLeft(),t:s.scrollTop(),w:s.width(),h:s.height()},o,a,h,r,p,n;if(this.opts.alignTo=="cursor"){o=a=h=this.eventX;r=p=n=this.eventY}else{var l=this.$elm.offset(),d={l:l.left,t:l.top,w:this.$elm.outerWidth(),h:this.$elm.outerHeight()};o=d.l+(this.opts.alignX!="inner-right"?0:d.w);a=o+Math.floor(d.w/2);h=o+(this.opts.alignX!="inner-left"?d.w:0);r=d.t+(this.opts.alignY!="inner-bottom"?0:d.h);p=r+Math.floor(d.h/2);n=r+(this.opts.alignY!="inner-top"?d.h:0)}switch(this.opts.alignX){case"right":case"inner-left":i.l=h+this.opts.offsetX;if(this.opts.keepInViewport&&i.l+this.tipOuterW>e.l+e.w)i.l=e.l+e.w-this.tipOuterW;if(this.opts.alignX=="right"||this.opts.alignY=="center")i.arrow="left";break;case"center":i.l=a-Math.floor(this.tipOuterW/2);if(this.opts.keepInViewport){if(i.l+this.tipOuterW>e.l+e.w)i.l=e.l+e.w-this.tipOuterW;else if(i.l<e.l)i.l=e.l}break;default:i.l=o-this.tipOuterW-this.opts.offsetX;if(this.opts.keepInViewport&&i.l<e.l)i.l=e.l;if(this.opts.alignX=="left"||this.opts.alignY=="center")i.arrow="right"}switch(this.opts.alignY){case"bottom":case"inner-top":i.t=n+this.opts.offsetY;if(!i.arrow||this.opts.alignTo=="cursor")i.arrow="top";if(this.opts.keepInViewport&&i.t+this.tipOuterH>e.t+e.h){i.t=r-this.tipOuterH-this.opts.offsetY;if(i.arrow=="top")i.arrow="bottom"}break;case"center":i.t=p-Math.floor(this.tipOuterH/2);if(this.opts.keepInViewport){if(i.t+this.tipOuterH>e.t+e.h)i.t=e.t+e.h-this.tipOuterH;else if(i.t<e.t)i.t=e.t}break;default:i.t=r-this.tipOuterH-this.opts.offsetY;if(!i.arrow||this.opts.alignTo=="cursor")i.arrow="bottom";if(this.opts.keepInViewport&&i.t<e.t){i.t=n+this.opts.offsetY;if(i.arrow=="bottom")i.arrow="top"}}this.pos=i}};t.fn.poshytip=function(i){if(typeof i=="string"){var s=arguments,e=i;Array.prototype.shift.call(s);if(e=="destroy"){this.die?this.die("mouseenter.poshytip").die("focus.poshytip"):t(document).undelegate(this.selector,"mouseenter.poshytip").undelegate(this.selector,"focus.poshytip")}return this.each(function(){var i=t(this).data("poshytip");if(i&&i[e])i[e].apply(i,s)})}var o=t.extend({},t.fn.poshytip.defaults,i);var a=document.createElement("link");a.rel="stylesheet";a.type="text/css";a.media="screen";a.href=easyloader.URI+"/js/easyjs/js/plugins/poshytip/"+o.className+"/"+o.className+".css";document.getElementsByTagName("head")[0].appendChild(a);if(!t("#poshytip-css-"+o.className)[0])t(['<style id="poshytip-css-',o.className,'" type="text/css">',"div.",o.className,"{visibility:hidden;position:absolute;top:0;left:0;}","div.",o.className," table.tip-table, div.",o.className," table.tip-table td{margin:0;font-family:inherit;font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;vertical-align:middle;}","div.",o.className," td.tip-bg-image span{display:block;font:1px/1px sans-serif;height:",o.bgImageFrameSize,"px;width:",o.bgImageFrameSize,"px;overflow:hidden;}","div.",o.className," td.tip-right{background-position:100% 0;}","div.",o.className," td.tip-bottom{background-position:100% 100%;}","div.",o.className," td.tip-left{background-position:0 100%;}","div.",o.className," div.tip-inner{background-position:-",o.bgImageFrameSize,"px -",o.bgImageFrameSize,"px;}","div.",o.className," div.tip-arrow{visibility:hidden;position:absolute;overflow:hidden;font:1px/1px sans-serif;}","</style>"].join("")).appendTo("head");if(o.liveEvents&&o.showOn!="none"){var h,r=t.extend({},o,{liveEvents:false});switch(o.showOn){case"hover":h=function(){var i=t(this);if(!i.data("poshytip"))i.poshytip(r).poshytip("mouseenter")};this.live?this.live("mouseenter.poshytip",h):t(document).delegate(this.selector,"mouseenter.poshytip",h);break;case"focus":h=function(){var i=t(this);if(!i.data("poshytip"))i.poshytip(r).poshytip("showDelayed")};this.live?this.live("focus.poshytip",h):t(document).delegate(this.selector,"focus.poshytip",h);break}return this}return this.each(function(){new t.Poshytip(this,o)})};t.fn.poshytip.defaults={content:"[title]",className:"tip-yellow",bgImageFrameSize:10,showTimeout:500,hideTimeout:100,timeOnScreen:0,showOn:"hover",liveEvents:false,alignTo:"cursor",alignX:"right",alignY:"top",offsetX:-22,offsetY:18,keepInViewport:true,allowTipHover:true,followCursor:false,fade:true,slide:true,slideOffset:8,showAniDuration:300,hideAniDuration:300,refreshAniDuration:200}})(jQuery);