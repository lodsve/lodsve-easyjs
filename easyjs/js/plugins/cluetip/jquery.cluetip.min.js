(function(e){e.cluetip={version:"1.2.9",template:["<div>",'<div class="cluetip-outer">','<h3 class="cluetip-title ui-widget-header ui-cluetip-header"></h3>','<div class="cluetip-inner ui-widget-content ui-cluetip-content"></div>',"</div>",'<div class="cluetip-extra"></div>',"</div>"].join(""),setup:{insertionType:"appendTo",insertionElement:"body"},defaults:{multiple:false,width:275,height:"auto",cluezIndex:97,positionBy:"auto",topOffset:15,leftOffset:15,snapToEdge:false,local:false,localPrefix:null,localIdSuffix:null,hideLocal:true,attribute:"rel",titleAttribute:"title",splitTitle:"",escapeTitle:false,showTitle:true,cluetipClass:"default",hoverClass:"",waitImage:true,cursor:"help",arrows:false,dropShadow:true,dropShadowSteps:6,sticky:false,mouseOutClose:false,delayedClose:50,activation:"hover",clickThrough:true,tracking:false,closePosition:"top",closeText:"Close",truncate:0,fx:{open:"show",openSpeed:""},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(e){return true},onShow:function(e,t){},onHide:function(e,t){},ajaxCache:true,ajaxProcess:function(e){e=e.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm,"").replace(/<(link|meta)[^>]+>/g,"");return e},ajaxSettings:{dataType:"html"},debug:false}};var t,i="cluetip ui-widget ui-widget-content ui-cluetip",o={},l=0,a=0;e.fn.attrProp=e.fn.prop||e.fn.attr;e.fn.cluetip=function(s,n){var r,u,c,p,f,d;if(typeof s=="object"){n=s;s=null}if(s=="destroy"){this.each(function(t){var i=e(this),o=i.data("cluetip");if(o){e(o.selector).remove();e.removeData(this,"title");e.removeData(this,"cluetip")}if(o.title){i.attrProp("title",o.title)}i.unbind(".cluetip").unbind("cluetipMoc")});if(!e('[id^="cluetip"]').length){e(document).unbind(".cluetip")}return this}n=e.extend(true,{},e.cluetip.defaults,n||{});l++;var h,v=e.cluetip.backCompat||!n.multiple?"cluetip":"cluetip-"+l,m="#"+v,g=e.cluetip.backCompat?"#":".",b=e.cluetip.setup.insertionType,x=e.cluetip.setup.insertionElement||"body";b=/appendTo|prependTo|insertBefore|insertAfter/.test(b)?b:"appendTo";r=e(m);if(!r.length){r=e(e.cluetip.template)[b](x).attr("id",v).css({position:"absolute",display:"none"});h=+n.cluezIndex;c=r.find(g+"cluetip-outer").css({position:"relative",zIndex:h});u=r.find(g+"cluetip-inner");p=r.find(g+"cluetip-title");r.bind("mouseenter mouseleave",function(t){e(this).data("entered",t.type==="mouseenter")})}t=e("#cluetip-waitimage");if(!t.length&&n.waitImage){t=e("<div></div>").attr("id","cluetip-waitimage").css({position:"absolute"});t.insertBefore(r).hide()}var w=(parseInt(r.css("paddingLeft"),10)||0)+(parseInt(r.css("paddingRight"),10)||0);this.each(function(l){var v=this,b=e(this),y=e.extend(true,{},n,e.metadata?b.metadata():e.meta?b.data():b.data("cluetip")||{}),I=false,T=false,k=null,j=y[y.attribute]||(y.attribute=="href"?b.attr(y.attribute):b.attrProp(y.attribute)||b.attr(y.attribute)),z=y.cluetipClass;h=+y.cluezIndex;b.data("cluetip",{title:v.title,zIndex:h,selector:m,cursor:v.style.cursor||""});if(y.arrows&&!r.find(".cluetip-arrows").length){r.append('<div class="cluetip-arrows ui-state-default"></div>')}if(!j&&!y.splitTitle&&!s){return true}if(y.local&&y.localPrefix){j=y.localPrefix+j}if(y.local&&y.hideLocal&&j){e(j+":first").hide()}var B=parseInt(y.topOffset,10),P=parseInt(y.leftOffset,10);var O,M,A=isNaN(parseInt(y.height,10))?"auto":/\D/g.test(y.height)?y.height:y.height+"px";var L,N,E,Y,H,D,R;var X=parseInt(y.width,10)||275,W=X+w+y.dropShadowSteps,$=this.offsetWidth,q,Q,U,F,G;var J;var K=y.attribute!="title"?b.attr(y.titleAttribute)||"":"";if(y.splitTitle){J=K.split(y.splitTitle);K=y.showTitle||J[0]===""?J.shift():""}if(y.escapeTitle){K=K.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}var V;function Z(){return false}b.bind("mouseenter mouseleave",function(e){var t=b.data("cluetip");t.entered=e.type==="entered";b.data("cluetip",t)});var _=function(i){var d,h,w,S=y.onActivate.call(v,i);if(S===false){return false}T=true;r=e(m).css({position:"absolute"});c=r.find(g+"cluetip-outer");u=r.find(g+"cluetip-inner");p=r.find(g+"cluetip-title");f=r.find(g+"cluetip-arrows");r.removeClass().css({width:X});if(j==b.attr("href")){b.css("cursor",y.cursor)}if(y.hoverClass){b.addClass(y.hoverClass)}N=Y=b.offset().top;E=N+b.innerHeight();q=b.offset().left;if(e(x).css("position")==="relative"){q-=e(x)[0].getBoundingClientRect().left}$=b.innerWidth();if(i.type==focus){F=q+$/2+P;r.css({left:Q});D=Y+B}else{F=i.pageX;D=i.pageY}if(v.tagName.toLowerCase()!="area"){L=e(document).scrollTop();G=e(window).width()}if(y.positionBy=="fixed"){Q=$+q+P;r.css({left:Q})}else{Q=$>q&&q>W||q+$+W+P>G?q-W-P:$+q+P;if(v.tagName.toLowerCase()=="area"||y.positionBy=="mouse"||$+W>G){if(F+20+W>G){r.addClass("cluetip-"+z);Q=F-W-P>=0?F-W-P-parseInt(r.css("marginLeft"),10)+parseInt(u.css("marginRight"),10):F-W/2}else{Q=F+P}}d=Q<0?i.pageY+B:i.pageY;if(Q<0||y.positionBy=="bottomTop"||y.positionBy=="topBottom"){Q=F+W/2>G?G/2-W/2:Math.max(F-W/2,0)}}f.css({zIndex:b.data("cluetip").zIndex+1});r.css({left:Q,zIndex:b.data("cluetip").zIndex});M=e(window).height();if(s){if(typeof s=="function"){s=s.call(v)}u.html(s);et(d)}else if(J){var k=J.length;u.html(k?J[0]:"");if(k>1){for(var O=1;O<k;O++){u.append('<div class="split-body">'+J[O]+"</div>")}}et(d)}else if(!y.local&&j.indexOf("#")!==0){if(/\.(jpe?g|tiff?|gif|png)(?:\?.*)?$/i.test(j)){u.html('<img src="'+j+'" alt="'+K+'" />');et(d)}else{var A=y.ajaxSettings.beforeSend,H=y.ajaxSettings.error,R=y.ajaxSettings.success,U=y.ajaxSettings.complete;w=C(j,y.ajaxSettings.data);var V={cache:y.ajaxCache,url:j,beforeSend:function(e,i){if(A){A.call(v,e,r,u,i)}c.children().empty();if(y.waitImage){t.css({top:D+20,left:F+20,zIndex:b.data("cluetip").zIndex-1}).show()}},error:function(e,t){if(n.ajaxCache&&!o[w]){o[w]={status:"error",textStatus:t,xhr:e}}if(T){if(H){H.call(v,e,t,r,u)}else{u.html("<i>sorry, the contents could not be loaded</i>")}}},success:function(e,t,i){if(n.ajaxCache&&!o[w]){o[w]={status:"success",data:e,textStatus:t,xhr:i}}I=y.ajaxProcess.call(v,e);if(typeof I=="object"&&I!==null){K=I.title;I=I.content}if(T){if(R){R.call(v,e,t,r,u)}u.html(I)}},complete:function(i,o){if(U){U.call(v,i,o,r,u)}var l=u[0].getElementsByTagName("img");a=l.length;for(var s=0,n=l.length;s<n;s++){if(l[s].complete){a--}}if(a){e(l).bind("load.ct error.ct",function(){a--;if(a===0){t.hide();e(l).unbind(".ct");if(T){et(d)}}})}else{t.hide();if(T){et(d)}}}};h=e.extend(true,{},y.ajaxSettings,V);if(o[w]){at(o[w],h)}else{e.ajax(h)}}}else if(y.local){var Z=e(j+(/^#\S+$/.test(j)?"":":eq("+l+")")).clone(true).show();if(y.localIdSuffix){Z.attr("id",Z[0].id+y.localIdSuffix)}u.html(Z);et(d)}};var et=function(t){var o,l,a,s=K||y.showTitle&&"&nbsp;",n="",h="",m=false;var g={bottom:function(e){e.appendTo(u)},top:function(e){e.prependTo(u)},title:function(e){e.prependTo(p)}};r.addClass("cluetip-"+z);if(y.truncate){var x=u.text().slice(0,y.truncate)+"...";u.html(x)}if(s){p.show().html(s)}else{p.hide()}if(y.sticky){if(g[y.closePosition]){o=e('<div class="cluetip-close"><a href="#">'+y.closeText+"</a></div>");g[y.closePosition](o);o.bind("click.cluetip",function(){it();return false})}if(y.mouseOutClose){b.unbind("mouseleave.cluetipMoc");r.unbind("mouseleave.cluetipMoc");if(y.mouseOutClose=="both"||y.mouseOutClose=="cluetip"||y.mouseOutClose===true){r.bind("mouseleave.cluetipMoc",ot)}if(y.mouseOutClose=="both"||y.mouseOutClose=="link"){b.bind("mouseleave.cluetipMoc",ot)}}}c.css({zIndex:b.data("cluetip").zIndex,overflow:A=="auto"?"visible":"auto",height:A});O=A=="auto"?Math.max(r.outerHeight(),r.height()):parseInt(A,10);H=Y;R=L+M;m=Q<F&&Math.max(Q,0)+W>F;if(y.positionBy=="fixed"){H=Y-y.dropShadowSteps+B}else if(y.positionBy=="topBottom"||y.positionBy=="bottomTop"||m){if(y.positionBy=="topBottom"){if(Y+O+B<R&&D-L<O+B){h="bottom"}else{h="top"}}else if(y.positionBy=="bottomTop"||m){if(Y+O+B>R&&D-L>O+B){h="top"}else{h="bottom"}}if(y.snapToEdge){if(h=="top"){H=N-O-B}else if(h=="bottom"){H=E+B}}else{if(h=="top"){H=D-O-B}else if(h=="bottom"){H=D+B}}}else if(Y+O+B>R){H=O>=M?L:R-O-B}else if(b.css("display")=="block"||v.tagName.toLowerCase()=="area"||y.positionBy=="mouse"){H=t-B}else{H=Y-y.dropShadowSteps}if(h===""){h=Q<q?"left":"right"}l=" clue-"+h+"-"+z+" cluetip-"+z;if(z=="rounded"){l+=" ui-corner-all"}r.css({top:H+"px"}).attrProp({className:i+l});if(y.arrows){if(/(left|right)/.test(h)){a=r.height()-f.height();n=Q>=0&&t>0?Y-H-y.dropShadowSteps:0;n=a>n?n:a;n+="px"}f.css({top:n}).show()}else{f.hide()}d=S(r,y);if(d&&d.length){d.hide().css({height:O,width:X,zIndex:b.data("cluetip").zIndex-1}).show()}if(!k){r.hide()}clearTimeout(k);k=null;r[y.fx.open](y.fx.openSpeed||0);if(e.fn.bgiframe){r.bgiframe()}y.onShow.call(v,r,u)};var tt=function(e){T=false;t.hide();if(!y.sticky||/click|toggle/.test(y.activation)){if(y.delayedClose>0){clearTimeout(k);k=null;k=setTimeout(it,y.delayedClose)}else{it();clearTimeout(k)}}if(y.hoverClass){b.removeClass(y.hoverClass)}};var it=function(t){var i=t&&t.data("cluetip")?t:b,o=i.data("cluetip")&&i.data("cluetip").selector,l=o||"div.cluetip",a=e(l),s=a.find(g+"cluetip-inner"),n=a.find(g+"cluetip-arrows");a.hide().removeClass();y.onHide.call(i[0],a,s);if(o){i.removeClass("cluetip-clicked");b.css("cursor",b.data("cluetip").cursor)}if(o&&K){i.attrProp(y.titleAttribute,K)}if(y.arrows){n.css({top:""})}if(d){d.hide()}};var ot=function(){var e=this;clearTimeout(k);k=setTimeout(function(){var t=b.data("cluetip").entered,i=r.data("entered"),o=false;if(y.mouseOutClose=="both"&&(t||i)){o=true}else if((y.mouseOutClose===true||y.mouseOutClose=="cluetip")&&i){o=true}else if(y.mouseOutClose=="link"&&t){o=true}if(!o){it.call(e)}},y.delayedClose)};e(document).unbind("hideCluetip.cluetip").bind("hideCluetip.cluetip",function(t){it(e(t.target))});if(/click|toggle/.test(y.activation)){b.bind("click.cluetip",function(t){if(r.is(":hidden")||!b.is(".cluetip-clicked")){_(t);e(".cluetip-clicked").removeClass("cluetip-clicked");b.addClass("cluetip-clicked")}else{tt(t)}return false})}else if(y.activation=="focus"){b.bind("focus.cluetip",function(e){b.attrProp("title","");_(e)});b.bind("blur.cluetip",function(e){b.attrProp("title",b.data("cluetip").title);tt(e)})}else{b[y.clickThrough?"unbind":"bind"]("click.cluetip",Z);var lt=function(e){if(y.tracking){var t=Q-e.pageX;var i=H?H-e.pageY:Y-e.pageY;b.bind("mousemove.cluetip",function(e){r.css({left:e.pageX+t,top:e.pageY+i})})}};if(e.fn.hoverIntent&&y.hoverIntent){b.hoverIntent({sensitivity:y.hoverIntent.sensitivity,interval:y.hoverIntent.interval,over:function(e){_(e);lt(e)},timeout:y.hoverIntent.timeout,out:function(e){tt(e);b.unbind("mousemove.cluetip")}})}else{b.bind("mouseenter.cluetip",function(e){_(e);lt(e)}).bind("mouseleave.cluetip",function(e){tt(e);b.unbind("mousemove.cluetip")})}b.bind("mouseover.cluetip",function(e){b.attrProp("title","")}).bind("mouseleave.cluetip",function(e){b.attrProp("title",b.data("cluetip").title)})}function at(e,t){var i=e.status;t.beforeSend(e.xhr,t);if(i=="error"){t[i](e.xhr,e.textStatus)}else if(i=="success"){t[i](e.data,e.textStatus,e.xhr)}t.complete(e.xhr,t.textStatus)}});function y(){}function C(t,i){var o=t||"";i=i||"";if(typeof i=="object"){e.each(i,function(e,t){o+="-"+e+"-"+t})}else if(typeof i=="string"){o+=i}return o}function S(t,i,o){var l="",a=i.dropShadow&&i.dropShadowSteps?+i.dropShadowSteps:0;if(e.support.boxShadow){if(a){l="1px 1px "+a+"px rgba(0,0,0,0.5)"}var s=a===0?"0 0 ":"1px 1px ";t.css(e.support.boxShadow,l);return false}var n=t.find(".cluetip-drop-shadow");if(a==n.length){return n}n.remove();var r=[];for(var u=0;u<a;){r[u++]='<div style="top:'+u+"px;left:"+u+'px;"></div>'}o=e(r.join("")).css({position:"absolute",backgroundColor:"#000",zIndex:h-1,opacity:.1}).addClass("cluetip-drop-shadow").prependTo(t);return o}return this};(function(){e.support=e.support||{};var t=document.createElement("div"),i=t.style,o=["boxShadow"],l=["moz","Moz","webkit","o"];for(var a=0,s=o.length;a<s;a++){var n=o[a],r=n.charAt(0).toUpperCase()+n.slice(1);if(typeof i[n]!=="undefined"){e.support[n]=n}else{for(var u=0,c=l.length;u<c;u++){if(typeof i[l[u]+r]!=="undefined"){e.support[n]=l[u]+r;break}}}}t=null})();e.fn.cluetip.defaults=e.cluetip.defaults})(jQuery);