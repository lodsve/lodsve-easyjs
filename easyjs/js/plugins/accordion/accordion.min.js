if(typeof LigerUIManagers=="undefined")LigerUIManagers={};(function(e){e.fn.ligerGetAccordionManager=function(){return LigerUIManagers[this[0].id+"_Accordion"]};e.fn.ligerRemoveAccordionManager=function(){return this.each(function(){LigerUIManagers[this.id+"_Accordion"]=null})};e.fn.ligerAccordion=function(o){this.each(function(){o=e.extend({height:null,speed:"normal",changeHeightOnResize:false,heightDiff:0},o||{});if(this.usedAccordion)return;var i={onResize:function(){if(!o.height||typeof o.height!="string"||o.height.indexOf("%")==-1)return false;if(i.accordion.parent()[0].tagName.toLowerCase()=="body"){var t=e(window).height();t-=parseInt(i.layout.parent().css("paddingTop"));t-=parseInt(i.layout.parent().css("paddingBottom"));i.height=o.heightDiff+t*parseFloat(i.height)*.01}else{i.height=o.heightDiff+i.accordion.parent().height()*parseFloat(o.height)*.01}i.accordion.height(i.height);i.setContentHeight(i.height-i.headerHoldHeight)},setHeight:function(o){i.accordion.height(o);o-=i.headerHoldHeight;e("> .l-accordion-content",i.accordion).height(o)},addTab:function(e){top.navtab.addTabItem({text:e.text?e.text:"空菜单",url:e.url?e.url:"#",tabid:e.menuId?e.menuId:null});setFrameZoneHeight(top_expanded)}};i.accordion=e(this);if(!i.accordion.hasClass("l-accordion-panel"))i.accordion.addClass("l-accordion-panel");var t=0;if(e("> div[lselected=true]",i.accordion).length>0)t=e("> div",i.accordion).index(e("> div[lselected=true]",i.accordion));e("> div",i.accordion).each(function(o,i){var c=e('<div class="l-accordion-header"><div class="l-accordion-toggle"></div><div class="l-accordion-header-inner"></div></div>');if(o==t&&o!=0)e(".l-accordion-toggle",c).addClass("l-accordion-toggle-open");if(e(i).attr("title")){e(".l-accordion-header-inner",c).html(e(i).attr("title"));e(i).attr("title","")}e(i).before(c);if(!e(i).hasClass("l-accordion-content"))e(i).addClass("l-accordion-content")});e("> .l-accordion-content li a",i.accordion).bind("click",function(){var o=e(this);var t=e("> .l-accordion-content li a",i.accordion);if(o.html()=="首页"||!o.attr("url"))return;i.addTab({text:o.html(),url:o.attr("url"),menuId:o.attr("menuId")?o.attr("menuId"):null});for(var c=0;c<t.length;c++)e(t[c]).removeClass("selected");if(!o.hasClass("selected"))o.addClass("selected")});e(".l-accordion-toggle",i.accordion).each(function(){if(!e(this).hasClass("l-accordion-toggle-open")&&!e(this).hasClass("l-accordion-toggle-close")){e(this).addClass("l-accordion-toggle-close")}if(e(this).hasClass("l-accordion-toggle-close")){e(this).parent().next(".l-accordion-content:visible").hide()}});e(".l-accordion-header",i.accordion).hover(function(){e(this).addClass("l-accordion-header-over")},function(){e(this).removeClass("l-accordion-header-over")});e(".l-accordion-toggle",i.accordion).hover(function(){if(e(this).hasClass("l-accordion-toggle-open"))e(this).addClass("l-accordion-toggle-open-over");else if(e(this).hasClass("l-accordion-toggle-close"))e(this).addClass("l-accordion-toggle-close-over")},function(){if(e(this).hasClass("l-accordion-toggle-open"))e(this).removeClass("l-accordion-toggle-open-over");else if(e(this).hasClass("l-accordion-toggle-close"))e(this).removeClass("l-accordion-toggle-close-over")});e(">.l-accordion-header",i.accordion).click(function(){if(!e(this).hasClass("l-accordion-selected"))e(this).addClass("l-accordion-selected");else e(this).removeClass("l-accordion-selected");e(this).siblings(".l-accordion-selected").removeClass("l-accordion-selected");var i=e(".l-accordion-toggle:first",this);if(i.hasClass("l-accordion-toggle-close")){i.removeClass("l-accordion-toggle-close").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over");i.addClass("l-accordion-toggle-open");e(this).next(".l-accordion-content").show(o.speed).siblings(".l-accordion-content:visible").hide(o.speed);e(this).siblings(".l-accordion-header").find(".l-accordion-toggle").removeClass("l-accordion-toggle-open").addClass("l-accordion-toggle-close")}else{i.removeClass("l-accordion-toggle-open").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over").addClass("l-accordion-toggle-close");e(this).next(".l-accordion-content").hide(o.speed)}});i.headerHoldHeight=0;e("> .l-accordion-header",i.accordion).each(function(){i.headerHoldHeight+=e(this).height()});if(o.height&&typeof o.height=="string"&&o.height.indexOf("%")>0){i.onResize();if(o.changeHeightOnResize){e(window).resize(function(){i.onResize()})}}else{if(o.height){i.height=o.heightDiff+o.height;i.accordion.height(i.height);i.setHeight(o.height)}else{i.header=i.accordion.height()}}if(this.id==undefined)this.id="LigerUI_"+(new Date).getTime();LigerUIManagers[this.id+"_Accordion"]=i;this.usedAccordion=true});if(this.length==0)return null;if(this.length==1)return LigerUIManagers[this[0].id+"_Accordion"];var i=[];this.each(function(){i.push(LigerUIManagers[this.id+"_Accordion"])});return i}})(jQuery);